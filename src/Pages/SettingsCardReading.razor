@page "/settings/card-reading"
@inherits Toolbox.Pages.SettingsPageBase

<PageTitle>@DisplayTexts.SettingsCardReadingPageTitle</PageTitle>

<h1>@DisplayTexts.SettingsCardReadingPageHeader</h1>

<HelpDialog @ref="HelpDialog" CloseButtonLabel="@DisplayTexts.HelpCloseButtonLabel" NotFoundMessage="@DisplayTexts.HelpNotFoundMessage" />

<section class="settings-section" aria-labelledby="card-reading-api-key-label">
    <div class="settings-label-row">
        <label id="card-reading-api-key-label" for="card-reading-api-key">@DisplayTexts.SettingsCardReadingApiKeyLabel</label>
    </div>
    <input
        id="card-reading-api-key"
        class="form-control"
        type="text"
        value="@gptApiKey"
        @oninput="OnApiKeyChanged" />
</section>

<section class="settings-section" aria-labelledby="card-reading-api-url-label">
    <div class="settings-label-row">
        <label id="card-reading-api-url-label" for="card-reading-api-url">@DisplayTexts.SettingsCardReadingApiUrlLabel</label>
    </div>
    <input
        id="card-reading-api-url"
        class="form-control"
        type="url"
        value="@chatGptApiUrl"
        @oninput="OnApiUrlChanged" />
</section>

<section class="settings-section" aria-labelledby="card-reading-test-label">
    <div class="settings-label-row">
        <label id="card-reading-test-label" for="card-reading-test-button">Direkt ChatGPT Test</label>
    </div>
    <button
        id="card-reading-test-button"
        class="btn btn-primary"
        @onclick="SendChatGptTestAsync"
        disabled="@isSendingTest">
        @if (isSendingTest)
        {
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            <span class="visually-hidden">Bitte wartenâ€¦</span>
        }
        else
        {
            <span>Direkt ChatGPT Test</span>
        }
    </button>

    @if (!string.IsNullOrWhiteSpace(testErrorMessage))
    {
        <div class="text-danger mt-2" role="alert">@testErrorMessage</div>
    }

    <textarea
        class="form-control mt-2"
        rows="6"
        readonly>@testResponse</textarea>
</section>
